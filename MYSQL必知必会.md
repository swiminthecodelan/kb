# MYSQL 必知必会

## 正则表达式

- MYSQL 中正则表达式不区分大小写，使用 BINARY 区分。(P54)
- ^两种用途：(P60)
    - 在集合中表达否定
    - 常规使用代表定位符串的开始处。
- 使用 SELECT 测试正则。(P61)

## 数据处理函数

- 使用函数需要做好代码注释，因为函数可移植性差，不同 DBMS 实现不一致。
- 文本处理函数(p69)
- 日期和时间处理函数(p71)
- 日期格式必须为 yyyy-mm-dd
- 应该总是用4位数字的年份
- 如果要的是日期，请使用 Date()
- 数值处理函数(p74)

## 聚集函数

- 聚集函数(p100)
- AVG()函数忽略列值为NULL的行。比如商品表价格为 null，聚集函数不会（例如求平均值）计入 null 为 0。因此数值型列要设置 NN，或者说尽量字段非必要都设置。(p101)
- 如果指定列名，则指定列的值为空的行被COUNT()
函数忽略，但如果COUNT()函数中用的是星号（*）统计行数，则不忽略。
- MAX()函数忽略列值为NULL的行。
- MAX()函数可用于找出最大日期值。
- SUM()函数忽略列值为NULL的行。

## 分组数据

- GROUP BY 规定。(p112)
- 使用ROLLUP(p113)。包含 null 分组。
- HAVING和WHERE的差别(p114)。
- GROUP BY和ORDER BY的区别(p116)。
- 不要忘记ORDER BY，不要依赖 GROUP BY 排序。(p116)
- SELECT子句及其顺序(p118)

## 子查询

- 子查询最常见的使用
是在WHERE子句的IN操作符中，以及用来填充计算列。
- 列必须匹配(p125)
- 理应外合来建立查询(p128),不断构建不断测试

## 联结

- 维护引用完整性，避免外键无效。(p133)
- 内部联结：基于两个表之间的相等测试。
    - 不要忘了WHERE子句(p138)
    - ANSI SQL规范首选INNER JOIN语法。
    - 不要联结不必要的表。
- 自联结：表联结自身。为区分字段歧义，使用别名表。
    - 用自联结而不用子查询

## 组合查询

- 对于更复杂的过滤条件，或者从多个表（而不是单个表）中检索数据
的情形，使用UNION可能会使处理更简单。
- 在进行并(union)时有几条规则(p155)
- UNION与WHERE(p158)

## 全文本搜索

- LIKE 和 REGEXP 的限制(p161)
- 并非所有引擎都支持全文本搜索，例如 MyISAM 和 InnoDB。
- 创建表时根据需要启用全文本搜索。
- 不要在导入数据时使用FULLTEXT。(p163)
- 搜索不区分大小写 除非使用BINARY方式（本章中没有介绍），
否则全文本搜索不区分大小写。
- 使用完整的 Match() 说 明 传递给 Match() 的值必须与
FULLTEXT()定义中的相同。如果指定多个列，则必须列出它
们（而且次序正确）。
- 全文本布尔操作符(P172)
- 全文本搜索的使用说明(p174)

## 插入数据

- 插入完整的行
    - 如果某个列没有值，应该使用NULL值（假定表允许对该列指定空值）。
    - 各个列必须以它们在表定义中出现的次序填充。
- 插入行的一部分（列出具体列）
- 总是使用列的列表(p179)
- 省略列条件(p180)
- 设置低优先级提高整体性能(p180)
- 单条INSERT插入同一个表多个行，同时提高性能。(p181)
- INSERT SELECT中的列名(p184)

## 更新和删除数据

- 在UPDATE语句中使用子查询(p188)
- IGNORE关键字(p188)
- 删除表的内容而不是表。
- 更快的删除所有行。(p190)
- 更新和删除的指导原则 (p190)
- 在对UPDATE或DELETE语句使用WHERE子句前，应该先用SELECT进
行测试。

## 创建和操纵表

- 处理现有的表(p194)
- 覆盖AUTO_INCREMENT(p199)
- 确定AUTO_INCREMENT值(p199)
- 默认值：
    - 不允许函数
    - 使用默认值而不是NULL值
- 引擎(p201)
    - 创建表时声明表的引擎。ENGINE=语句
    - 外键不能跨引擎(p202)
- 小心使用ALTER TABLE
- 复杂的表结构更改一般需要手动删除过程(p203)

## 视图

- 视图的一些常见应用(p208)
- 性能问题(p208)
- 视图的规则和限制(p209)
- 创建可重用的视图(210)
- WHERE子句与WHERE子句(p213)
- 将视图用于检索(p215)

## 存储过程

- 存储过程使用理由(p218)
- mysql命令行客户机的分隔符DELIMITER //(p220)
- MySQL支持IN（传递给存储过程）、OUT（从存储过程传出，如这里所用）和INOUT（对存储过程传入和传出）类型的参
数。
- 参数的数据类型
- 所有MySQL变量都必须以@开始。

## 游标

- 通常REPEAT语句的语法使它更适合于对游标进行循
环。
- DECLARE语句的次序

## 触发器

- 保持每个数据库的触发器名唯一(p242)
- 触发器按每个表每个事件每次地定义，每个表每个事件每次只允许一个触发器。(p243)
- 触发器失败(p243)
- 触发器不能更新或覆盖。为了修改一个触发器，必须先删除它，然后再重新创建。
- 只有表才支持触发器，视图不支持（临时表也不
支持）。
- BEFORE或AFTER？(P244)
- 多语句触发器（P245）

## 管理事务处理

- 并非所有引擎都支持事务处理。（P249）
- 事务处理术语（P251）
- 哪些语句可以回退？（P252）
- 隐含事务关闭（P253）
- 为进行明确的提交，使用COMMIT语句。COMMIT语句仅在不出错时写出更改。
- 保留点越多越好（P254）
- 标志为连接专用（P255）

## 全球化和本地化

- 临时区分大小写（p260）
- 串可以在字符集之间进行转换。为此，使用Cast()或Convert()函数。
- 防止无意的错误
- 不要使用root

## 安全管理

- 用户定义为user@host（p267）
- 可以授予或撤销的每个权限。（p269）
- 未来的授权（p270）
- 简化多次授权（p270）

## 数据库维护

- 备份数据（p273）
- 首先刷新未写数据（p273）
- 如果从一个表中删除大量数据，应该使用OPTIMIZE TABLE来收回所用的空间，从而优化表的性能。

## 改善性能
